<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ–°ä»™äºŒå® ç‰©åŠ ç‚¹æ¨¡æ‹Ÿå™¨</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            text-align: center;
            padding: 30px;
            font-size: 28px;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .main-content {
            padding: 30px;
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 30px;
        }

        .section {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
        }

        .section-title {
            font-size: 20px;
            font-weight: bold;
            color: #333;
            margin-bottom: 20px;
            text-align: center;
            padding-bottom: 10px;
            border-bottom: 3px solid #667eea;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            font-weight: bold;
            margin-bottom: 5px;
            color: #555;
        }

        .form-group input {
            width: 100%;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
            transition: border-color 0.3s;
        }

        .form-group input:focus {
            outline: none;
            border-color: #667eea;
        }

        .attribute-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 15px;
            background: white;
            padding: 10px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }

        .attribute-name {
            font-weight: bold;
            min-width: 60px;
            color: #333;
        }

        .attribute-controls {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s;
        }

        .btn:hover {
            background: #5a6fd8;
        }

        .btn:active {
            transform: translateY(1px);
        }
        
        .btn-sm:active {
            background: #4a5fd1 !important;
            transform: scale(0.95);
        }

        .btn-sm {
            padding: 5px 10px;
            font-size: 12px;
            min-width: 30px;
        }

        .btn-random {
            background: #28a745;
            width: 100%;
            margin-top: 15px;
            padding: 12px;
            font-size: 16px;
        }

        .btn-random:hover {
            background: #218838;
        }

        .attribute-value {
            font-weight: bold;
            color: #333;
            min-width: 40px;
            text-align: center;
            background: transparent;
            border: 1px solid transparent;
            padding: 4px 8px;
            border-radius: 4px;
            transition: all 0.3s;
            cursor: pointer;
        }
        
        .attribute-value:hover {
            background: #f0f0f0;
            border-color: #ddd;
        }
        
        .attribute-input {
            font-weight: bold;
            color: #333;
            min-width: 40px;
            text-align: center;
            background: white;
            border: 2px solid #667eea;
            padding: 4px 8px;
            border-radius: 4px;
            outline: none;
            font-size: 14px;
        }

        .stat-display {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }

        .stat-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }

        .stat-name {
            font-weight: bold;
            color: #555;
        }

        .stat-value {
            font-weight: bold;
            color: #667eea;
        }

        .remaining-points {
            text-align: center;
            font-size: 18px;
            font-weight: bold;
            color: #e74c3c;
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }

        .aptitude-range {
            font-size: 12px;
            color: #666;
            margin-top: 2px;
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .header {
                padding: 20px;
                font-size: 24px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            ğŸ² æ–°ä»™äºŒå® ç‰©åŠ ç‚¹æ¨¡æ‹Ÿå™¨ ğŸ²
        </div>
        
        <div class="main-content">
            <!-- åŸºç¡€è®¾ç½®åŒºåŸŸ -->
            <div class="section">
                <div class="section-title">âš™ï¸ åŸºç¡€è®¾ç½®</div>
                
                <div class="form-group">
                    <label for="level">ç­‰çº§:</label>
                    <input type="number" id="level" min="0" max="150" value="0">
                </div>
                
                <div class="remaining-points">
                    å‰©ä½™å±æ€§ç‚¹: <span id="remainingPoints">0</span>
                </div>
                
                <div class="attribute-row">
                    <span class="attribute-name">ä½“è´¨</span>
                    <div class="attribute-controls">
                        <button class="btn btn-sm" 
                                onmousedown="startLongPress('constitution', -1)" 
                                onmouseup="stopLongPress()" 
                                onmouseleave="stopLongPress()"
                                onclick="changeAttribute('constitution', -1)">-</button>
                        <span class="attribute-value" id="constitution" 
                              onclick="startEdit('constitution')"
                              title="ç‚¹å‡»ç¼–è¾‘æ•°å€¼">10</span>
                        <button class="btn btn-sm" 
                                onmousedown="startLongPress('constitution', 1)" 
                                onmouseup="stopLongPress()" 
                                onmouseleave="stopLongPress()"
                                onclick="changeAttribute('constitution', 1)">+</button>
                    </div>
                </div>
                
                <div class="attribute-row">
                    <span class="attribute-name">é­”åŠ›</span>
                    <div class="attribute-controls">
                        <button class="btn btn-sm" 
                                onmousedown="startLongPress('magic', -1)" 
                                onmouseup="stopLongPress()" 
                                onmouseleave="stopLongPress()"
                                onclick="changeAttribute('magic', -1)">-</button>
                        <span class="attribute-value" id="magic" 
                              onclick="startEdit('magic')"
                              title="ç‚¹å‡»ç¼–è¾‘æ•°å€¼">10</span>
                        <button class="btn btn-sm" 
                                onmousedown="startLongPress('magic', 1)" 
                                onmouseup="stopLongPress()" 
                                onmouseleave="stopLongPress()"
                                onclick="changeAttribute('magic', 1)">+</button>
                    </div>
                </div>
                
                <div class="attribute-row">
                    <span class="attribute-name">åŠ›é‡</span>
                    <div class="attribute-controls">
                        <button class="btn btn-sm" 
                                onmousedown="startLongPress('strength', -1)" 
                                onmouseup="stopLongPress()" 
                                onmouseleave="stopLongPress()"
                                onclick="changeAttribute('strength', -1)">-</button>
                        <span class="attribute-value" id="strength" 
                              onclick="startEdit('strength')"
                              title="ç‚¹å‡»ç¼–è¾‘æ•°å€¼">10</span>
                        <button class="btn btn-sm" 
                                onmousedown="startLongPress('strength', 1)" 
                                onmouseup="stopLongPress()" 
                                onmouseleave="stopLongPress()"
                                onclick="changeAttribute('strength', 1)">+</button>
                    </div>
                </div>
                
                <div class="attribute-row">
                    <span class="attribute-name">è€åŠ›</span>
                    <div class="attribute-controls">
                        <button class="btn btn-sm" 
                                onmousedown="startLongPress('endurance', -1)" 
                                onmouseup="stopLongPress()" 
                                onmouseleave="stopLongPress()"
                                onclick="changeAttribute('endurance', -1)">-</button>
                        <span class="attribute-value" id="endurance" 
                              onclick="startEdit('endurance')"
                              title="ç‚¹å‡»ç¼–è¾‘æ•°å€¼">10</span>
                        <button class="btn btn-sm" 
                                onmousedown="startLongPress('endurance', 1)" 
                                onmouseup="stopLongPress()" 
                                onmouseleave="stopLongPress()"
                                onclick="changeAttribute('endurance', 1)">+</button>
                    </div>
                </div>
                
                <div class="attribute-row">
                    <span class="attribute-name">æ•æ·</span>
                    <div class="attribute-controls">
                        <button class="btn btn-sm" 
                                onmousedown="startLongPress('agility', -1)" 
                                onmouseup="stopLongPress()" 
                                onmouseleave="stopLongPress()"
                                onclick="changeAttribute('agility', -1)">-</button>
                        <span class="attribute-value" id="agility" 
                              onclick="startEdit('agility')"
                              title="ç‚¹å‡»ç¼–è¾‘æ•°å€¼">10</span>
                        <button class="btn btn-sm" 
                                onmousedown="startLongPress('agility', 1)" 
                                onmouseup="stopLongPress()" 
                                onmouseleave="stopLongPress()"
                                onclick="changeAttribute('agility', 1)">+</button>
                    </div>
                </div>
            </div>
            
            <!-- èµ„è´¨è®¾ç½®åŒºåŸŸ -->
            <div class="section">
                <div class="section-title">ğŸ“Š èµ„è´¨è®¾ç½®</div>
                
                <div class="form-group">
                    <label for="attackApt">æ”»å‡»èµ„è´¨:</label>
                    <input type="number" id="attackApt" min="900" max="1800" value="1350">
                    <div class="aptitude-range">èŒƒå›´: 900-1800</div>
                </div>
                
                <div class="form-group">
                    <label for="defenseApt">é˜²å¾¡èµ„è´¨:</label>
                    <input type="number" id="defenseApt" min="850" max="1700" value="1275">
                    <div class="aptitude-range">èŒƒå›´: 850-1700</div>
                </div>
                
                <div class="form-group">
                    <label for="hpApt">ä½“åŠ›èµ„è´¨:</label>
                    <input type="number" id="hpApt" min="3500" max="7000" value="5250">
                    <div class="aptitude-range">èŒƒå›´: 3500-7000</div>
                </div>
                
                <div class="form-group">
                    <label for="mpApt">æ³•åŠ›èµ„è´¨:</label>
                    <input type="number" id="mpApt" min="2100" max="4200" value="3150">
                    <div class="aptitude-range">èŒƒå›´: 2100-4200</div>
                </div>
                
                <div class="form-group">
                    <label for="speedApt">é€Ÿåº¦èµ„è´¨:</label>
                    <input type="number" id="speedApt" min="300" max="600" value="450">
                    <div class="aptitude-range">èŒƒå›´: 300-600</div>
                </div>
                
                <div class="form-group">
                    <label for="growth">æˆé•¿:</label>
                    <input type="number" id="growth" min="1" max="1.5" step="0.01" value="1.25">
                    <div class="aptitude-range">èŒƒå›´: 1.00-1.50</div>
                </div>
                
                <button class="btn btn-random" onclick="randomizeAptitudes()">ğŸ² éšæœºèµ„è´¨</button>
            </div>
            
            <!-- å±æ€§æ˜¾ç¤ºåŒºåŸŸ -->
            <div class="section">
                <div class="section-title">ğŸ“ˆ å® ç‰©å±æ€§</div>
                
                <div class="stat-display">
                    <div class="stat-row">
                        <span class="stat-name">ğŸ”¥ ä½“åŠ›:</span>
                        <span class="stat-value" id="finalHp">0</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-name">ğŸ’™ çœŸæ°”:</span>
                        <span class="stat-value" id="finalMp">0</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-name">âš”ï¸ æ”»å‡»:</span>
                        <span class="stat-value" id="finalAttack">0</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-name">ğŸ›¡ï¸ é˜²å¾¡:</span>
                        <span class="stat-value" id="finalDefense">0</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-name">âœ¨ çµåŠ›:</span>
                        <span class="stat-value" id="finalSpirit">0</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-name">ğŸ’¨ èº«æ³•:</span>
                        <span class="stat-value" id="finalSpeed">0</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // å® ç‰©æ•°æ®
        let petData = {
            level: 0,
            constitution: 10,
            magic: 10,
            strength: 10,
            endurance: 10,
            agility: 10,
            attackApt: 1350,
            defenseApt: 1275,
            hpApt: 5250,
            mpApt: 3150,
            speedApt: 450,
            growth: 1.25
        };
        
        // é•¿æŒ‰ç›¸å…³å˜é‡
        let longPressTimer = null;
        let longPressAttribute = null;
        let longPressChange = 0;
        let longPressSpeed = 200; // åˆå§‹é€Ÿåº¦ (æ¯«ç§’)
        let longPressCount = 0;
        let isLongPressing = false;
        
        // ç¼–è¾‘ç›¸å…³å˜é‡
        let currentEditingAttribute = null;
        let originalValue = 0;

        // åˆå§‹åŒ–
        function init() {
            updateLevel();
            calculateStats();
            
            // ç»‘å®šäº‹ä»¶ç›‘å¬å™¨
            document.getElementById('level').addEventListener('change', updateLevel);
            
            const aptitudeInputs = ['attackApt', 'defenseApt', 'hpApt', 'mpApt', 'speedApt', 'growth'];
            aptitudeInputs.forEach(id => {
                document.getElementById(id).addEventListener('input', () => {
                    petData[id] = parseFloat(document.getElementById(id).value);
                    calculateStats();
                });
            });
        }

        // æ›´æ–°ç­‰çº§
        function updateLevel() {
            const newLevel = parseInt(document.getElementById('level').value);
            const oldLevel = petData.level;
            petData.level = newLevel;
            
            // è®¡ç®—ç­‰çº§å˜åŒ–å¸¦æ¥çš„ç‚¹æ•°å˜åŒ–
            const levelDiff = newLevel - oldLevel;
            const pointsChange = levelDiff * 10;
            
            // è·å–å½“å‰å‰©ä½™ç‚¹æ•°å¹¶æ›´æ–°
            const currentRemainingPoints = getRemainingPoints();
            const newRemainingPoints = currentRemainingPoints + pointsChange;
            
            // å¦‚æœæ–°çš„å‰©ä½™ç‚¹æ•°ä¸ºè´Ÿæ•°ï¼Œè¯´æ˜å½“å‰åˆ†é…çš„ç‚¹æ•°è¶…è¿‡äº†æ–°ç­‰çº§å…è®¸çš„æ€»ç‚¹æ•°
            // éœ€è¦é‡æ–°åˆ†é…å±æ€§ç‚¹
            if (newRemainingPoints < 0) {
                // é‡ç½®åˆ°åŸºç¡€çŠ¶æ€ï¼šæ¯ä¸ªå±æ€§10ç‚¹
                petData.constitution = 10;
                petData.magic = 10;
                petData.strength = 10;
                petData.endurance = 10;
                petData.agility = 10;
                
                // é‡æ–°è®¡ç®—å‰©ä½™ç‚¹æ•°
                const basePoints = 50; // 5ä¸ªå±æ€§ Ã— 10ç‚¹
                const totalAvailablePoints = basePoints + (newLevel * 10);
                const newRemainingPoints = totalAvailablePoints - basePoints;
                
                updateRemainingPoints(newRemainingPoints);
            } else {
                updateRemainingPoints(newRemainingPoints);
            }
            
            updateAttributeDisplay();
            calculateStats();
        }

        // æ”¹å˜å±æ€§ç‚¹
        function changeAttribute(attributeName, change) {
            const currentValue = petData[attributeName];
            const newValue = currentValue + change;
            
            // æ£€æŸ¥æ˜¯å¦å¯ä»¥å‡å°‘ï¼ˆä¸èƒ½ä½äº10ç‚¹ï¼‰
            if (change < 0 && newValue < 10) {
                return;
            }
            
            // æ£€æŸ¥æ˜¯å¦æœ‰è¶³å¤Ÿçš„å‰©ä½™ç‚¹æ•°
            const remainingPoints = getRemainingPoints();
            if (change > 0 && remainingPoints < change) {
                return;
            }
            
            petData[attributeName] = newValue;
            updateAttributeDisplay();
            updateRemainingPoints(remainingPoints - change);
            calculateStats();
        }

        // è·å–å‰©ä½™å±æ€§ç‚¹
        function getRemainingPoints() {
            const basePoints = 50; // 5ä¸ªå±æ€§åŸºç¡€å„10ç‚¹
            const levelPoints = petData.level * 10; // æ¯çº§10ç‚¹
            const totalAvailablePoints = basePoints + levelPoints;
            const usedPoints = petData.constitution + petData.magic + petData.strength + petData.endurance + petData.agility;
            return totalAvailablePoints - usedPoints;
        }

        // æ›´æ–°å±æ€§æ˜¾ç¤º
        function updateAttributeDisplay() {
            document.getElementById('constitution').textContent = petData.constitution;
            document.getElementById('magic').textContent = petData.magic;
            document.getElementById('strength').textContent = petData.strength;
            document.getElementById('endurance').textContent = petData.endurance;
            document.getElementById('agility').textContent = petData.agility;
        }

        // æ›´æ–°å‰©ä½™ç‚¹æ•°æ˜¾ç¤º
        function updateRemainingPoints(points) {
            document.getElementById('remainingPoints').textContent = points;
        }

        // éšæœºèµ„è´¨
        function randomizeAptitudes() {
            petData.attackApt = Math.floor(Math.random() * (1800 - 900 + 1)) + 900;
            petData.defenseApt = Math.floor(Math.random() * (1700 - 850 + 1)) + 850;
            petData.hpApt = Math.floor(Math.random() * (7000 - 3500 + 1)) + 3500;
            petData.mpApt = Math.floor(Math.random() * (4200 - 2100 + 1)) + 2100;
            petData.speedApt = Math.floor(Math.random() * (600 - 300 + 1)) + 300;
            petData.growth = Math.round((Math.random() * (1.5 - 1) + 1) * 100) / 100;
            
            // æ›´æ–°è¾“å…¥æ¡†æ˜¾ç¤º
            document.getElementById('attackApt').value = petData.attackApt;
            document.getElementById('defenseApt').value = petData.defenseApt;
            document.getElementById('hpApt').value = petData.hpApt;
            document.getElementById('mpApt').value = petData.mpApt;
            document.getElementById('speedApt').value = petData.speedApt;
            document.getElementById('growth').value = petData.growth;
            
            calculateStats();
        }

        // è®¡ç®—å® ç‰©å±æ€§
        function calculateStats() {
            const level = petData.level;
            const growth = petData.growth;
            
            // ä½“åŠ›=ç­‰çº§*ä½“åŠ›èµ„è´¨/1000+ä½“è´¨ç‚¹æ•°*æˆé•¿*6
            const hp = Math.floor(level * petData.hpApt / 1000 + petData.constitution * growth * 6);
            
            // çœŸæ°”=ç­‰çº§*æ³•åŠ›èµ„è´¨/500+é­”åŠ›ç‚¹æ•°*æˆé•¿*3
            const mp = Math.floor(level * petData.mpApt / 500 + petData.magic * growth * 3);
            
            // æ”»å‡»=[(ç­‰çº§*æ”»å‡»èµ„è´¨/1000)*4/3*(1.4+æˆé•¿)]+(åŠ›é‡ç‚¹æ•°*æˆé•¿)
            const attack = Math.floor((level * petData.attackApt / 1000) * 4 / 3 * (1.4 + growth) + petData.strength * growth);
            
            // é˜²å¾¡=[(ç­‰çº§*é˜²å¾¡èµ„è´¨/1000)*7/8*(1.4+æˆé•¿)]+(è€åŠ›ç‚¹æ•°*æˆé•¿*1.33)
            const defense = Math.floor((level * petData.defenseApt / 1000) * 7 / 8 * (1.4 + growth) + petData.endurance * growth * 1.33);
            
            // çµåŠ›=[ç­‰çº§*(æ³•åŠ›èµ„è´¨*3+5000)/10000]+(ä½“è´¨ç‚¹æ•°*0.3)+(è€åŠ›ç‚¹æ•°*0.2)+(åŠ›é‡ç‚¹æ•°*0.4)+(æ³•åŠ›ç‚¹æ•°*0.7)
            const spirit = Math.floor(level * (petData.mpApt * 3 + 5000) / 10000 + 
                                    petData.constitution * 0.3 + 
                                    petData.endurance * 0.2 + 
                                    petData.strength * 0.4 + 
                                    petData.magic * 0.7);
            
            // èº«æ³•=æ•æ·ç‚¹æ•°*é€Ÿåº¦èµ„è´¨/10000
            const speed = 20 + Math.floor(petData.agility * petData.speedApt / 10000);
            
            // æ›´æ–°æ˜¾ç¤º
            document.getElementById('finalHp').textContent = hp;
            document.getElementById('finalMp').textContent = mp;
            document.getElementById('finalAttack').textContent = attack;
            document.getElementById('finalDefense').textContent = defense;
            document.getElementById('finalSpirit').textContent = spirit;
            document.getElementById('finalSpeed').textContent = speed;
        }

        // é•¿æŒ‰å¼€å§‹
        function startLongPress(attributeName, change) {
            // é˜²æ­¢é‡å¤è§¦å‘
            if (isLongPressing) return;
            
            longPressAttribute = attributeName;
            longPressChange = change;
            longPressSpeed = 200; // é‡ç½®é€Ÿåº¦
            longPressCount = 0;
            isLongPressing = true;
            
            // å»¶è¿Ÿ500msåå¼€å§‹é•¿æŒ‰æ•ˆæœ
            longPressTimer = setTimeout(() => {
                continueLongPress();
            }, 500);
        }
        
        // ç»§ç»­é•¿æŒ‰
        function continueLongPress() {
            if (!isLongPressing) return;
            
            // æ‰§è¡Œå±æ€§å˜æ›´
            changeAttribute(longPressAttribute, longPressChange);
            longPressCount++;
            
            // è®¡ç®—åŠ é€Ÿï¼šæ¯5æ¬¡æ“ä½œé€Ÿåº¦æå‡20%ï¼Œæœ€å¿«50ms
            if (longPressCount % 5 === 0 && longPressSpeed > 10) {
                longPressSpeed = Math.max(10, longPressSpeed * 0.8);
            }
            
            // è®¾ç½®ä¸‹ä¸€æ¬¡è§¦å‘
            longPressTimer = setTimeout(() => {
                continueLongPress();
            }, longPressSpeed);
        }
        
        // åœæ­¢é•¿æŒ‰
        function stopLongPress() {
            if (longPressTimer) {
                clearTimeout(longPressTimer);
                longPressTimer = null;
            }
            isLongPressing = false;
            longPressAttribute = null;
            longPressChange = 0;
            longPressCount = 0;
        }
        
        // å¼€å§‹ç¼–è¾‘å±æ€§å€¼
        function startEdit(attributeName) {
            // å¦‚æœæ­£åœ¨ç¼–è¾‘å…¶ä»–å±æ€§ï¼Œå…ˆå®Œæˆä¹‹å‰çš„ç¼–è¾‘
            if (currentEditingAttribute && currentEditingAttribute !== attributeName) {
                finishEdit(false);
            }
            
            // å¦‚æœæ­£åœ¨é•¿æŒ‰ï¼Œåœæ­¢é•¿æŒ‰
            if (isLongPressing) {
                stopLongPress();
            }
            
            currentEditingAttribute = attributeName;
            originalValue = petData[attributeName];
            
            const element = document.getElementById(attributeName);
            const currentValue = petData[attributeName];
            
            // åˆ›å»ºè¾“å…¥æ¡†
            const input = document.createElement('input');
            input.type = 'number';
            input.value = currentValue;
            input.min = '10';
            input.className = 'attribute-input';
            input.id = attributeName + '_input';
            
            // æ›¿æ¢æ˜¾ç¤ºå…ƒç´ 
            element.style.display = 'none';
            element.parentNode.insertBefore(input, element.nextSibling);
            
            // èšç„¦å¹¶é€‰ä¸­å†…å®¹
            input.focus();
            input.select();
            
            // ç»‘å®šäº‹ä»¶
            input.addEventListener('keydown', function(e) {
                if (e.key === 'Enter') {
                    finishEdit(true);
                } else if (e.key === 'Escape') {
                    finishEdit(false);
                }
            });
            
            input.addEventListener('blur', function() {
                finishEdit(true);
            });
        }
        
        // å®Œæˆç¼–è¾‘
        function finishEdit(apply) {
            if (!currentEditingAttribute) return;
            
            const attributeName = currentEditingAttribute;
            const element = document.getElementById(attributeName);
            const input = document.getElementById(attributeName + '_input');
            
            if (input) {
                if (apply) {
                    const newValue = parseInt(input.value);
                    
                    // éªŒè¯è¾“å…¥å€¼
                    if (!isNaN(newValue) && newValue >= 10) {
                        // è®¡ç®—ç‚¹æ•°å˜åŒ–
                        const pointChange = newValue - petData[attributeName];
                        const remainingPoints = getRemainingPoints();
                        
                        // æ£€æŸ¥æ˜¯å¦æœ‰è¶³å¤Ÿçš„å‰©ä½™ç‚¹æ•°
                        if (pointChange <= remainingPoints) {
                            // åº”ç”¨æ–°å€¼
                            petData[attributeName] = newValue;
                            updateAttributeDisplay();
                            updateRemainingPoints(remainingPoints - pointChange);
                            calculateStats();
                        } else {
                            // ç‚¹æ•°ä¸è¶³ï¼Œæ˜¾ç¤ºæç¤º
                            alert(`ç‚¹æ•°ä¸è¶³ï¼æœ€å¤šè¿˜èƒ½åˆ†é… ${remainingPoints} ç‚¹`);
                            // æ¢å¤åŸå€¼
                            element.textContent = petData[attributeName];
                        }
                    } else {
                        // è¾“å…¥æ— æ•ˆï¼Œæ¢å¤åŸå€¼
                        alert('è¯·è¾“å…¥æœ‰æ•ˆæ•°å€¼ï¼ˆæœ€å°å€¼ä¸º10ï¼‰');
                        element.textContent = petData[attributeName];
                    }
                } else {
                    // å–æ¶ˆç¼–è¾‘ï¼Œæ¢å¤åŸå€¼
                    element.textContent = petData[attributeName];
                }
                
                // ç§»é™¤è¾“å…¥æ¡†ï¼Œæ˜¾ç¤ºåŸå…ƒç´ 
                input.remove();
                element.style.display = '';
            }
            
            currentEditingAttribute = null;
            originalValue = 0;
        }
        
        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', init);
        
        // é˜²æ­¢å³é”®èœå•å¹²æ‰°é•¿æŒ‰åŠŸèƒ½
        document.addEventListener('contextmenu', function(e) {
            if (e.target.classList.contains('btn-sm')) {
                e.preventDefault();
            }
        });
    </script>
</body>
</html>
