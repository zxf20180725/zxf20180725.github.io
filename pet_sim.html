<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Êñ∞‰ªô‰∫åÂÆ†Áâ©Âä†ÁÇπÊ®°ÊãüÂô®</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            text-align: center;
            padding: 30px;
            font-size: 28px;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .main-content {
            padding: 30px;
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 30px;
        }

        .section {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
        }

        .section-title {
            font-size: 20px;
            font-weight: bold;
            color: #333;
            margin-bottom: 20px;
            text-align: center;
            padding-bottom: 10px;
            border-bottom: 3px solid #667eea;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            font-weight: bold;
            margin-bottom: 5px;
            color: #555;
        }

        .form-group input {
            width: 100%;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
            transition: border-color 0.3s;
        }

        .form-group input:focus {
            outline: none;
            border-color: #667eea;
        }

        .attribute-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 15px;
            background: white;
            padding: 10px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }

        .attribute-name {
            font-weight: bold;
            min-width: 60px;
            color: #333;
        }

        .attribute-controls {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s;
        }

        .btn:hover {
            background: #5a6fd8;
        }

        .btn:active {
            transform: translateY(1px);
        }
        
        .btn-sm:active {
            background: #4a5fd1 !important;
            transform: scale(0.95);
        }

        .btn-sm {
            padding: 5px 10px;
            font-size: 12px;
            min-width: 30px;
        }

        .btn-random {
            background: #28a745;
            width: 100%;
            margin-top: 15px;
            padding: 12px;
            font-size: 16px;
        }

        .btn-random:hover {
            background: #218838;
        }

        .attribute-value {
            font-weight: bold;
            color: #333;
            min-width: 40px;
            text-align: center;
            background: transparent;
            border: 1px solid transparent;
            padding: 4px 8px;
            border-radius: 4px;
            transition: all 0.3s;
            cursor: pointer;
        }
        
        .attribute-value:hover {
            background: #f0f0f0;
            border-color: #ddd;
        }
        
        .attribute-input {
            font-weight: bold;
            color: #333;
            min-width: 40px;
            text-align: center;
            background: white;
            border: 2px solid #667eea;
            padding: 4px 8px;
            border-radius: 4px;
            outline: none;
            font-size: 14px;
        }

        .stat-display {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }

        .stat-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }

        .stat-name {
            font-weight: bold;
            color: #555;
        }

        .stat-value {
            font-weight: bold;
            color: #667eea;
        }

        .remaining-points {
            text-align: center;
            font-size: 18px;
            font-weight: bold;
            color: #e74c3c;
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }

        .aptitude-range {
            font-size: 12px;
            color: #666;
            margin-top: 2px;
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .header {
                padding: 20px;
                font-size: 24px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            üê≤ Êñ∞‰ªô‰∫åÂÆ†Áâ©Âä†ÁÇπÊ®°ÊãüÂô® üê≤
        </div>
        <!-- Â§ßÂè∑ÊåâÈíÆÂºèÈìæÊé• -->
<a href="chat.html"
   style="
      display:inline-block;
      padding:20px 40px;
      font-size:24px;
      color:#fff;
      background:#007bff;
      text-decoration:none;
      border-radius:8px;">
  ËøõÂÖ•ËÅäÂ§©
</a>
        <div class="main-content">
            <!-- Âü∫Á°ÄËÆæÁΩÆÂå∫Âüü -->
            <div class="section">
                <div class="section-title">‚öôÔ∏è Âü∫Á°ÄËÆæÁΩÆ</div>
                
                <div class="form-group">
                    <label for="level">Á≠âÁ∫ß:</label>
                    <input type="number" id="level" min="0" max="150" value="0">
                </div>
                
                <div class="remaining-points">
                    Ââ©‰ΩôÂ±ûÊÄßÁÇπ: <span id="remainingPoints">0</span>
                </div>
                
                <div class="attribute-row">
                    <span class="attribute-name">‰ΩìË¥®</span>
                    <div class="attribute-controls">
                        <button class="btn btn-sm" 
                                onmousedown="startLongPress('constitution', -1)" 
                                onmouseup="stopLongPress()" 
                                onmouseleave="stopLongPress()"
                                onclick="changeAttribute('constitution', -1)">-</button>
                        <span class="attribute-value" id="constitution" 
                              onclick="startEdit('constitution')"
                              title="ÁÇπÂáªÁºñËæëÊï∞ÂÄº">10</span>
                        <button class="btn btn-sm" 
                                onmousedown="startLongPress('constitution', 1)" 
                                onmouseup="stopLongPress()" 
                                onmouseleave="stopLongPress()"
                                onclick="changeAttribute('constitution', 1)">+</button>
                    </div>
                </div>
                
                <div class="attribute-row">
                    <span class="attribute-name">È≠îÂäõ</span>
                    <div class="attribute-controls">
                        <button class="btn btn-sm" 
                                onmousedown="startLongPress('magic', -1)" 
                                onmouseup="stopLongPress()" 
                                onmouseleave="stopLongPress()"
                                onclick="changeAttribute('magic', -1)">-</button>
                        <span class="attribute-value" id="magic" 
                              onclick="startEdit('magic')"
                              title="ÁÇπÂáªÁºñËæëÊï∞ÂÄº">10</span>
                        <button class="btn btn-sm" 
                                onmousedown="startLongPress('magic', 1)" 
                                onmouseup="stopLongPress()" 
                                onmouseleave="stopLongPress()"
                                onclick="changeAttribute('magic', 1)">+</button>
                    </div>
                </div>
                
                <div class="attribute-row">
                    <span class="attribute-name">ÂäõÈáè</span>
                    <div class="attribute-controls">
                        <button class="btn btn-sm" 
                                onmousedown="startLongPress('strength', -1)" 
                                onmouseup="stopLongPress()" 
                                onmouseleave="stopLongPress()"
                                onclick="changeAttribute('strength', -1)">-</button>
                        <span class="attribute-value" id="strength" 
                              onclick="startEdit('strength')"
                              title="ÁÇπÂáªÁºñËæëÊï∞ÂÄº">10</span>
                        <button class="btn btn-sm" 
                                onmousedown="startLongPress('strength', 1)" 
                                onmouseup="stopLongPress()" 
                                onmouseleave="stopLongPress()"
                                onclick="changeAttribute('strength', 1)">+</button>
                    </div>
                </div>
                
                <div class="attribute-row">
                    <span class="attribute-name">ËÄêÂäõ</span>
                    <div class="attribute-controls">
                        <button class="btn btn-sm" 
                                onmousedown="startLongPress('endurance', -1)" 
                                onmouseup="stopLongPress()" 
                                onmouseleave="stopLongPress()"
                                onclick="changeAttribute('endurance', -1)">-</button>
                        <span class="attribute-value" id="endurance" 
                              onclick="startEdit('endurance')"
                              title="ÁÇπÂáªÁºñËæëÊï∞ÂÄº">10</span>
                        <button class="btn btn-sm" 
                                onmousedown="startLongPress('endurance', 1)" 
                                onmouseup="stopLongPress()" 
                                onmouseleave="stopLongPress()"
                                onclick="changeAttribute('endurance', 1)">+</button>
                    </div>
                </div>
                
                <div class="attribute-row">
                    <span class="attribute-name">ÊïèÊç∑</span>
                    <div class="attribute-controls">
                        <button class="btn btn-sm" 
                                onmousedown="startLongPress('agility', -1)" 
                                onmouseup="stopLongPress()" 
                                onmouseleave="stopLongPress()"
                                onclick="changeAttribute('agility', -1)">-</button>
                        <span class="attribute-value" id="agility" 
                              onclick="startEdit('agility')"
                              title="ÁÇπÂáªÁºñËæëÊï∞ÂÄº">10</span>
                        <button class="btn btn-sm" 
                                onmousedown="startLongPress('agility', 1)" 
                                onmouseup="stopLongPress()" 
                                onmouseleave="stopLongPress()"
                                onclick="changeAttribute('agility', 1)">+</button>
                    </div>
                </div>
            </div>
            
            <!-- ËµÑË¥®ËÆæÁΩÆÂå∫Âüü -->
            <div class="section">
                <div class="section-title">üìä ËµÑË¥®ËÆæÁΩÆ</div>
                
                <div class="form-group">
                    <label for="attackApt">ÊîªÂáªËµÑË¥®:</label>
                    <input type="number" id="attackApt" min="900" max="1800" value="1350">
                    <div class="aptitude-range">ËåÉÂõ¥: 900-1800</div>
                </div>
                
                <div class="form-group">
                    <label for="defenseApt">Èò≤Âæ°ËµÑË¥®:</label>
                    <input type="number" id="defenseApt" min="850" max="1700" value="1275">
                    <div class="aptitude-range">ËåÉÂõ¥: 850-1700</div>
                </div>
                
                <div class="form-group">
                    <label for="hpApt">‰ΩìÂäõËµÑË¥®:</label>
                    <input type="number" id="hpApt" min="3500" max="7000" value="5250">
                    <div class="aptitude-range">ËåÉÂõ¥: 3500-7000</div>
                </div>
                
                <div class="form-group">
                    <label for="mpApt">Ê≥ïÂäõËµÑË¥®:</label>
                    <input type="number" id="mpApt" min="2100" max="4200" value="3150">
                    <div class="aptitude-range">ËåÉÂõ¥: 2100-4200</div>
                </div>
                
                <div class="form-group">
                    <label for="speedApt">ÈÄüÂ∫¶ËµÑË¥®:</label>
                    <input type="number" id="speedApt" min="300" max="600" value="450">
                    <div class="aptitude-range">ËåÉÂõ¥: 300-600</div>
                </div>
                
                <div class="form-group">
                    <label for="growth">ÊàêÈïø:</label>
                    <input type="number" id="growth" min="1" max="1.5" step="0.01" value="1.25">
                    <div class="aptitude-range">ËåÉÂõ¥: 1.00-1.50</div>
                </div>
                
                <button class="btn btn-random" onclick="randomizeAptitudes()">üé≤ ÈöèÊú∫ËµÑË¥®</button>
            </div>
            
            <!-- Â±ûÊÄßÊòæÁ§∫Âå∫Âüü -->
            <div class="section">
                <div class="section-title">üìà ÂÆ†Áâ©Â±ûÊÄß</div>
                
                <div class="stat-display">
                    <div class="stat-row">
                        <span class="stat-name">üî• ‰ΩìÂäõ:</span>
                        <span class="stat-value" id="finalHp">0</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-name">üíô ÁúüÊ∞î:</span>
                        <span class="stat-value" id="finalMp">0</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-name">‚öîÔ∏è ÊîªÂáª:</span>
                        <span class="stat-value" id="finalAttack">0</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-name">üõ°Ô∏è Èò≤Âæ°:</span>
                        <span class="stat-value" id="finalDefense">0</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-name">‚ú® ÁÅµÂäõ:</span>
                        <span class="stat-value" id="finalSpirit">0</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-name">üí® Ë∫´Ê≥ï:</span>
                        <span class="stat-value" id="finalSpeed">0</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ÂÆ†Áâ©Êï∞ÊçÆ
        let petData = {
            level: 0,
            constitution: 10,
            magic: 10,
            strength: 10,
            endurance: 10,
            agility: 10,
            attackApt: 1350,
            defenseApt: 1275,
            hpApt: 5250,
            mpApt: 3150,
            speedApt: 450,
            growth: 1.25
        };
        
        // ÈïøÊåâÁõ∏ÂÖ≥ÂèòÈáè
        let longPressTimer = null;
        let longPressAttribute = null;
        let longPressChange = 0;
        let longPressSpeed = 200; // ÂàùÂßãÈÄüÂ∫¶ (ÊØ´Áßí)
        let longPressCount = 0;
        let isLongPressing = false;
        
        // ÁºñËæëÁõ∏ÂÖ≥ÂèòÈáè
        let currentEditingAttribute = null;
        let originalValue = 0;

        // ÂàùÂßãÂåñ
        function init() {
            updateLevel();
            calculateStats();
            
            // ÁªëÂÆö‰∫ã‰ª∂ÁõëÂê¨Âô®
            document.getElementById('level').addEventListener('change', updateLevel);
            
            const aptitudeInputs = ['attackApt', 'defenseApt', 'hpApt', 'mpApt', 'speedApt', 'growth'];
            aptitudeInputs.forEach(id => {
                document.getElementById(id).addEventListener('input', () => {
                    petData[id] = parseFloat(document.getElementById(id).value);
                    calculateStats();
                });
            });
        }

        // Êõ¥Êñ∞Á≠âÁ∫ß
        function updateLevel() {
            const newLevel = parseInt(document.getElementById('level').value);
            const oldLevel = petData.level;
            const currentRemainingPoints = getRemainingPoints();
            petData.level = newLevel;
            
            // ËÆ°ÁÆóÁ≠âÁ∫ßÂèòÂåñÂ∏¶Êù•ÁöÑÁÇπÊï∞ÂèòÂåñ
            const levelDiff = newLevel - oldLevel;
            const pointsChange = levelDiff * 10;
            
            // Ëé∑ÂèñÂΩìÂâçÂâ©‰ΩôÁÇπÊï∞Âπ∂Êõ¥Êñ∞
            const newRemainingPoints = currentRemainingPoints + pointsChange;
            
            // Â¶ÇÊûúÊñ∞ÁöÑÂâ©‰ΩôÁÇπÊï∞‰∏∫Ë¥üÊï∞ÔºåËØ¥ÊòéÂΩìÂâçÂàÜÈÖçÁöÑÁÇπÊï∞Ë∂ÖËøá‰∫ÜÊñ∞Á≠âÁ∫ßÂÖÅËÆ∏ÁöÑÊÄªÁÇπÊï∞
            // ÈúÄË¶ÅÈáçÊñ∞ÂàÜÈÖçÂ±ûÊÄßÁÇπ
            if (newRemainingPoints < 0) {
                // ÈáçÁΩÆÂà∞Âü∫Á°ÄÁä∂ÊÄÅÔºöÊØè‰∏™Â±ûÊÄß10ÁÇπ
                petData.constitution = 10;
                petData.magic = 10;
                petData.strength = 10;
                petData.endurance = 10;
                petData.agility = 10;
                
                // ÈáçÊñ∞ËÆ°ÁÆóÂâ©‰ΩôÁÇπÊï∞ÔºöÊÄªÁÇπÊï∞ - Â∑≤‰ΩøÁî®ÁöÑÂü∫Á°ÄÁÇπÊï∞
                const totalPoints = 50 + (newLevel * 10);
                const usedPoints = 50; // 5‰∏™Â±ûÊÄßÂêÑ10ÁÇπ
                const finalRemainingPoints = totalPoints - usedPoints;
                
                updateRemainingPoints(finalRemainingPoints);
            } else {
                updateRemainingPoints(newRemainingPoints);
            }
            
            updateAttributeDisplay();
            calculateStats();
        }

        // ÊîπÂèòÂ±ûÊÄßÁÇπ
        function changeAttribute(attributeName, change) {
            const currentValue = petData[attributeName];
            const newValue = currentValue + change;
            
            // Ê£ÄÊü•ÊòØÂê¶ÂèØ‰ª•ÂáèÂ∞ëÔºà‰∏çËÉΩ‰Ωé‰∫é10ÁÇπÔºâ
            if (change < 0 && newValue < 10) {
                return;
            }
            
            // Ê£ÄÊü•ÊòØÂê¶ÊúâË∂≥Â§üÁöÑÂâ©‰ΩôÁÇπÊï∞
            const remainingPoints = getRemainingPoints();
            if (change > 0 && remainingPoints < change) {
                return;
            }
            
            petData[attributeName] = newValue;
            updateAttributeDisplay();
            updateRemainingPoints(remainingPoints - change);
            calculateStats();
        }

        // Ëé∑ÂèñÂâ©‰ΩôÂ±ûÊÄßÁÇπ
        function getRemainingPoints() {
            // ÊÄªÂèØÁî®ÁÇπÊï∞ = 50(Âü∫Á°Ä) + Á≠âÁ∫ß√ó10
            const totalAvailablePoints = 50 + (petData.level * 10);
            const usedPoints = petData.constitution + petData.magic + petData.strength + petData.endurance + petData.agility;
            return totalAvailablePoints - usedPoints;
        }

        // Êõ¥Êñ∞Â±ûÊÄßÊòæÁ§∫
        function updateAttributeDisplay() {
            document.getElementById('constitution').textContent = petData.constitution;
            document.getElementById('magic').textContent = petData.magic;
            document.getElementById('strength').textContent = petData.strength;
            document.getElementById('endurance').textContent = petData.endurance;
            document.getElementById('agility').textContent = petData.agility;
        }

        // Êõ¥Êñ∞Ââ©‰ΩôÁÇπÊï∞ÊòæÁ§∫
        function updateRemainingPoints(points) {
            document.getElementById('remainingPoints').textContent = points;
        }

        // ÈöèÊú∫ËµÑË¥®
        function randomizeAptitudes() {
            petData.attackApt = Math.floor(Math.random() * (1800 - 900 + 1)) + 900;
            petData.defenseApt = Math.floor(Math.random() * (1700 - 850 + 1)) + 850;
            petData.hpApt = Math.floor(Math.random() * (7000 - 3500 + 1)) + 3500;
            petData.mpApt = Math.floor(Math.random() * (4200 - 2100 + 1)) + 2100;
            petData.speedApt = Math.floor(Math.random() * (600 - 300 + 1)) + 300;
            petData.growth = Math.round((Math.random() * (1.5 - 1) + 1) * 100) / 100;
            
            // Êõ¥Êñ∞ËæìÂÖ•Ê°ÜÊòæÁ§∫
            document.getElementById('attackApt').value = petData.attackApt;
            document.getElementById('defenseApt').value = petData.defenseApt;
            document.getElementById('hpApt').value = petData.hpApt;
            document.getElementById('mpApt').value = petData.mpApt;
            document.getElementById('speedApt').value = petData.speedApt;
            document.getElementById('growth').value = petData.growth;
            
            calculateStats();
        }

        // ËÆ°ÁÆóÂÆ†Áâ©Â±ûÊÄß
        function calculateStats() {
            const level = petData.level;
            const growth = petData.growth;
            
            // ‰ΩìÂäõ=Á≠âÁ∫ß*‰ΩìÂäõËµÑË¥®/1000+‰ΩìË¥®ÁÇπÊï∞*ÊàêÈïø*6
            const hp = Math.floor(level * petData.hpApt / 1000 + petData.constitution * growth * 6);
            
            // ÁúüÊ∞î=Á≠âÁ∫ß*Ê≥ïÂäõËµÑË¥®/500+È≠îÂäõÁÇπÊï∞*ÊàêÈïø*3
            const mp = Math.floor(level * petData.mpApt / 500 + petData.magic * growth * 3);
            
            // ÊîªÂáª=[(Á≠âÁ∫ß*ÊîªÂáªËµÑË¥®/1000)*4/3*(1.4+ÊàêÈïø)]+(ÂäõÈáèÁÇπÊï∞*ÊàêÈïø)
            const attack = Math.floor((level * petData.attackApt / 1000) * 4 / 3 * (1.4 + growth) + petData.strength * growth);
            
            // Èò≤Âæ°=[(Á≠âÁ∫ß*Èò≤Âæ°ËµÑË¥®/1000)*7/8*(1.4+ÊàêÈïø)]+(ËÄêÂäõÁÇπÊï∞*ÊàêÈïø*1.33)
            const defense = Math.floor((level * petData.defenseApt / 1000) * 7 / 8 * (1.4 + growth) + petData.endurance * growth * 1.33);
            
            // ÁÅµÂäõ=[Á≠âÁ∫ß*(Ê≥ïÂäõËµÑË¥®*3+5000)/10000]+(‰ΩìË¥®ÁÇπÊï∞*0.3)+(ËÄêÂäõÁÇπÊï∞*0.2)+(ÂäõÈáèÁÇπÊï∞*0.4)+(Ê≥ïÂäõÁÇπÊï∞*0.7)
            const spirit = Math.floor(level * (petData.mpApt * 3 + 5000) / 10000 + 
                                    petData.constitution * 0.3 + 
                                    petData.endurance * 0.2 + 
                                    petData.strength * 0.4 + 
                                    petData.magic * 0.7);
            
            // Ë∫´Ê≥ï=ÊïèÊç∑ÁÇπÊï∞*ÈÄüÂ∫¶ËµÑË¥®/10000
            const speed = 20 + Math.floor(petData.agility * petData.speedApt / 10000);
            
            // Êõ¥Êñ∞ÊòæÁ§∫
            document.getElementById('finalHp').textContent = hp;
            document.getElementById('finalMp').textContent = mp;
            document.getElementById('finalAttack').textContent = attack;
            document.getElementById('finalDefense').textContent = defense;
            document.getElementById('finalSpirit').textContent = spirit;
            document.getElementById('finalSpeed').textContent = speed;
        }

        // ÈïøÊåâÂºÄÂßã
        function startLongPress(attributeName, change) {
            // Èò≤Ê≠¢ÈáçÂ§çËß¶Âèë
            if (isLongPressing) return;
            
            longPressAttribute = attributeName;
            longPressChange = change;
            longPressSpeed = 200; // ÈáçÁΩÆÈÄüÂ∫¶
            longPressCount = 0;
            isLongPressing = true;
            
            // Âª∂Ëøü500msÂêéÂºÄÂßãÈïøÊåâÊïàÊûú
            longPressTimer = setTimeout(() => {
                continueLongPress();
            }, 500);
        }
        
        // ÁªßÁª≠ÈïøÊåâ
        function continueLongPress() {
            if (!isLongPressing) return;
            
            // ÊâßË°åÂ±ûÊÄßÂèòÊõ¥
            changeAttribute(longPressAttribute, longPressChange);
            longPressCount++;
            
            // ËÆ°ÁÆóÂä†ÈÄüÔºöÊØè5Ê¨°Êìç‰ΩúÈÄüÂ∫¶ÊèêÂçá20%ÔºåÊúÄÂø´50ms
            if (longPressCount % 5 === 0 && longPressSpeed > 10) {
                longPressSpeed = Math.max(10, longPressSpeed * 0.8);
            }
            
            // ËÆæÁΩÆ‰∏ã‰∏ÄÊ¨°Ëß¶Âèë
            longPressTimer = setTimeout(() => {
                continueLongPress();
            }, longPressSpeed);
        }
        
        // ÂÅúÊ≠¢ÈïøÊåâ
        function stopLongPress() {
            if (longPressTimer) {
                clearTimeout(longPressTimer);
                longPressTimer = null;
            }
            isLongPressing = false;
            longPressAttribute = null;
            longPressChange = 0;
            longPressCount = 0;
        }
        
        // ÂºÄÂßãÁºñËæëÂ±ûÊÄßÂÄº
        function startEdit(attributeName) {
            // Â¶ÇÊûúÊ≠£Âú®ÁºñËæëÂÖ∂‰ªñÂ±ûÊÄßÔºåÂÖàÂÆåÊàê‰πãÂâçÁöÑÁºñËæë
            if (currentEditingAttribute && currentEditingAttribute !== attributeName) {
                finishEdit(false);
            }
            
            // Â¶ÇÊûúÊ≠£Âú®ÈïøÊåâÔºåÂÅúÊ≠¢ÈïøÊåâ
            if (isLongPressing) {
                stopLongPress();
            }
            
            currentEditingAttribute = attributeName;
            originalValue = petData[attributeName];
            
            const element = document.getElementById(attributeName);
            const currentValue = petData[attributeName];
            
            // ÂàõÂª∫ËæìÂÖ•Ê°Ü
            const input = document.createElement('input');
            input.type = 'number';
            input.value = currentValue;
            input.min = '10';
            input.className = 'attribute-input';
            input.id = attributeName + '_input';
            
            // ÊõøÊç¢ÊòæÁ§∫ÂÖÉÁ¥†
            element.style.display = 'none';
            element.parentNode.insertBefore(input, element.nextSibling);
            
            // ËÅöÁÑ¶Âπ∂ÈÄâ‰∏≠ÂÜÖÂÆπ
            input.focus();
            input.select();
            
            // ÁªëÂÆö‰∫ã‰ª∂
            input.addEventListener('keydown', function(e) {
                if (e.key === 'Enter') {
                    finishEdit(true);
                } else if (e.key === 'Escape') {
                    finishEdit(false);
                }
            });
            
            input.addEventListener('blur', function() {
                finishEdit(true);
            });
        }
        
        // ÂÆåÊàêÁºñËæë
        function finishEdit(apply) {
            if (!currentEditingAttribute) return;
            
            const attributeName = currentEditingAttribute;
            const element = document.getElementById(attributeName);
            const input = document.getElementById(attributeName + '_input');
            
            if (input) {
                if (apply) {
                    const newValue = parseInt(input.value);
                    
                    // È™åËØÅËæìÂÖ•ÂÄº
                    if (!isNaN(newValue) && newValue >= 10) {
                        // ËÆ°ÁÆóÁÇπÊï∞ÂèòÂåñ
                        const pointChange = newValue - petData[attributeName];
                        const remainingPoints = getRemainingPoints();
                        
                        // Ê£ÄÊü•ÊòØÂê¶ÊúâË∂≥Â§üÁöÑÂâ©‰ΩôÁÇπÊï∞
                        if (pointChange <= remainingPoints) {
                            // Â∫îÁî®Êñ∞ÂÄº
                            petData[attributeName] = newValue;
                            updateAttributeDisplay();
                            updateRemainingPoints(remainingPoints - pointChange);
                            calculateStats();
                        } else {
                            // ÁÇπÊï∞‰∏çË∂≥ÔºåÊòæÁ§∫ÊèêÁ§∫
                            alert(`ÁÇπÊï∞‰∏çË∂≥ÔºÅÊúÄÂ§öËøòËÉΩÂàÜÈÖç ${remainingPoints} ÁÇπ`);
                            // ÊÅ¢Â§çÂéüÂÄº
                            element.textContent = petData[attributeName];
                        }
                    } else {
                        // ËæìÂÖ•Êó†ÊïàÔºåÊÅ¢Â§çÂéüÂÄº
                        alert('ËØ∑ËæìÂÖ•ÊúâÊïàÊï∞ÂÄºÔºàÊúÄÂ∞èÂÄº‰∏∫10Ôºâ');
                        element.textContent = petData[attributeName];
                    }
                } else {
                    // ÂèñÊ∂àÁºñËæëÔºåÊÅ¢Â§çÂéüÂÄº
                    element.textContent = petData[attributeName];
                }
                
                // ÁßªÈô§ËæìÂÖ•Ê°ÜÔºåÊòæÁ§∫ÂéüÂÖÉÁ¥†
                input.remove();
                element.style.display = '';
            }
            
            currentEditingAttribute = null;
            originalValue = 0;
        }
        
        // È°µÈù¢Âä†ËΩΩÂÆåÊàêÂêéÂàùÂßãÂåñ
        document.addEventListener('DOMContentLoaded', init);
        
        // Èò≤Ê≠¢Âè≥ÈîÆËèúÂçïÂπ≤Êâ∞ÈïøÊåâÂäüËÉΩ
        document.addEventListener('contextmenu', function(e) {
            if (e.target.classList.contains('btn-sm')) {
                e.preventDefault();
            }
        });
    </script>
</body>
</html>
